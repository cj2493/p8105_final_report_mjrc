---
title: "Final Report"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(httr)
library(rvest)
library(openintro)
library(ggmap)
library(patchwork)
library(modelr)
library(purrr)
library(flexdashboard)
library(viridis)
library(plotly)
library(stringr)
library(p8105.datasets)
library(kableExtra)
library(shiny)
```

## Team Members and UNIs:

Melanie Mayer; mm4963  
Jaisal Amin; ja3314  
Rebekah Yu; dry2115  
Courtney Johnson; cj2493  
  
## Motivation:  

The motivations for this project are to explore the impact of public health initiatives on health outcome, explore regional differences in health outcomes and the efficacy of public health initiatives, and explore if population size affects health.  

## Related WOrk:  

## Initial Questions:  

What are the associations between (1) prevalence of lack of health insurance, (2) regular health practices (i.e. pap smear, doctor visits, mammograms), and (3) health outcomes (diabetes, kidney disease, smoking). We also plan on  creating geographical visualizations of the prevalence of health outcomes by region?

## Data:  
Our data was taken from the 500 cities project. The data used for their analysis was obtained from the Centers of Disease Control, Division of Population Health, Epidemiology, and Surveillance Branch. The dataset provides model-based estimates for the prevalence of various diseases/practices in order to help local public health officials better serve their communities. We filtered out many variables and ultimately chose to only keep diseases associated with higher rates of fatality and/or those that placed a higher burden on our healthcare system. We also kept variables that could be clearly classified as "health practices" or behaviors whose primary purpose is to maintain or improve one's health. Because we were interested in the relationship between these variables and health insurance/expenditure, we kept the variable associated with prevalence of lack of insurance and imported data on healthcare expenditure by state from the Henry J. Kaiser Family Foundation. In order to conduct regional analysis, we imported a dataset that classified states based on region.



## Exploratory Analysis:  

## Additional Analysis:  

### Regression Analysis: 

To explore the relationship between commonly used health practices and health outcomes, we tried to fit some multiple linear regression models using backwards selection.  The models we created were attempting to predict the prevalence of cancer, high cholesterol and diabetes. For each model, we started with all of the health practice variables: core screenings for men, core screenings for women, dental visits, lack of physical activity, mammogram usage, routine checkups, 
cholesterol screenings, and colon screenings. All of these variables are also in terms of prevalence. Then, to show the results in a way that people who aren't statisticians could understand, I produced a table for each model that showed which variables were included in the final model and the direction of effect they had on the disease prevalence.  

```{r, cancer_model}
cancer_full_mod = lm(CANCER_AdjPrev ~ COREM_AdjPrev + COREW_AdjPrev + DENTAL_AdjPrev + LPA_AdjPrev + MAMMOUSE_AdjPrev + PAPTEST_AdjPrev + CHECKUP_AdjPrev + CHOLSCREEN_AdjPrev + COLON_SCREEN_AdjPrev, data = cdc_df)
summary(cancer_full_mod)
cancer_minus_1 = update(cancer_full_mod, . ~ . -COREW_AdjPrev)
summary(cancer_minus_1)
cancer_minus_2 = update(cancer_minus_1, . ~ . -LPA_AdjPrev)
summary(cancer_minus_2)
cancer_minus_3 = update(cancer_minus_2, . ~ . -CHOLSCREEN_AdjPrev)
summary(cancer_minus_3)
cancer_minus_4 = update(cancer_minus_3, . ~ . -PAPTEST_AdjPrev)
summary(cancer_minus_4)
```

```{r, cancer_tbl}
health_practice = c("Core Practices for Men", "Dental Visits", "Mammogram Usage",
                    "Routine Checkups", "Colon Screening")
effect = c("Positive", "Negative", "Negative", "Negative", "Positive")
estimate = c(0.012, -0.033, -0.036, -0.0095, 0.107)
p_val = c(0.012, '1.06e-14', '2.31e-06', 0.0295, '< 2e-16')
cancer_tbl = tibble(
  "Health Practice" = health_practice,
  "Effect on Cancer Prevalence" = effect,
  "Coefficient Estimate" = estimate,
  "P-Value" = p_val
)
cancer_tbl %>%
  knitr::kable() %>%
  kable_styling(bootstrap_options = "striped", full_width = T, position = "center")
```

```{r, chol_model}
chol_full_mod = lm(HIGHCHOL_AdjPrev ~ COREM_AdjPrev + COREW_AdjPrev + DENTAL_AdjPrev + LPA_AdjPrev + MAMMOUSE_AdjPrev + PAPTEST_AdjPrev + CHECKUP_AdjPrev + CHOLSCREEN_AdjPrev + COLON_SCREEN_AdjPrev, data = cdc_df)
summary(chol_full_mod)
chol_minus_1 = update(chol_full_mod, . ~ . -CHOLSCREEN_AdjPrev) 
summary(chol_minus_1)
chol_minus_2 = update(chol_minus_1, . ~ . -COREW_AdjPrev)
summary(chol_minus_2)
chol_minus_3 = update(chol_minus_2, . ~ . -COREM_AdjPrev)
summary(chol_minus_3)
chol_minus_4 = update(chol_minus_3, . ~ . -MAMMOUSE_AdjPrev)
summary(chol_minus_4)
chol_minus_5 = update(chol_minus_4, . ~ . -PAPTEST_AdjPrev)
summary(chol_minus_5)
```

```{r, chol_tbl}
health_practice = c("Dental Visits", "Lack of Physical Activity",
                    "Routine Checkups", "Colon Screening")
effect = c("Negative", "Positive", "Positive", "Positive")
estimate = c(-0.064, 0.171, 0.0401, 0.061)
p_val = c(0.004, '9.18e-07', 0.049, 0.037)
chol_tbl = tibble(
  "Health Practice" = health_practice,
  "Effect on High Cholesterol Prevalence" = effect,
  "Coefficient Estimate" = estimate,
  "P-Value" = p_val
)
chol_tbl %>%
  knitr::kable() %>%
  kable_styling(bootstrap_options = "striped", full_width = T, position = "center")
```

```{r, diab_model}
diab_full_mod = lm(DIABETES_AdjPrev ~ COREM_AdjPrev + COREW_AdjPrev + DENTAL_AdjPrev + LPA_AdjPrev + MAMMOUSE_AdjPrev + PAPTEST_AdjPrev + CHECKUP_AdjPrev + CHOLSCREEN_AdjPrev + COLON_SCREEN_AdjPrev, data = cdc_df)
summary(diab_full_mod)
diab_minus_1 = update(diab_full_mod, . ~ . -COLON_SCREEN_AdjPrev)
summary(diab_minus_1)
diab_minus_2 = update(diab_minus_1, . ~ . -PAPTEST_AdjPrev)
summary(diab_minus_2)
diab_minus_3 = update(diab_minus_2, . ~ . -COREM_AdjPrev)
summary(diab_minus_3)
```

```{r, diab_tbl}
health_practice = c("Core Practices for Women", "Dental Visits", "Lack of Physical Activity", "Mammogram Usage", "Routine Checkups", "Cholesterol Screening")
effect = c("Negative", "Negative", "Positive", "Positive", "Positive", "Negative")
estimate = c(-0.063, -0.135, 0.193, 0.085, 0.076, -0.074)
p_val = c('6.19e-11', '< 2e-16', '< 2e-16', '1.44e-08', '1.33e-08', 0.0004)
diab_tbl = tibble(
  "Health Practice" = health_practice,
  "Effect on Diabetes Prevalence" = effect,
  "Coefficient Estimate" = estimate,
  "P-Value" = p_val
)
diab_tbl %>%
  knitr::kable() %>%
  kable_styling(bootstrap_options = "striped", full_width = T, position = "center")
```






## Discussion:  